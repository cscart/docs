*************************************************
Как прикреплять файлы к товарам, используя импорт
*************************************************

В CS-Cart можно :doc:`прикреплять файлы к товарам </user_guide/addons/attachments/attach_files>` (например, инструкции или схемы). Для того, чтобы это сделать, необходим модуль :doc:`/user_guide/addons/attachments/index`. Обычно файл можно прикрепить в настройках любого товара, но если и товаров, и файлов много, то удобнее это сделать разом через :doc:`импорт товаров </user_guide/manage_products/import_export/advanced_product_import>`.

Прежде чем импортировать товары с файлами, вам необходимо куда-то загрузить эти файлы. Есть два основных варианта, где их хранить:

* на внешнем сервере или серверах (чтобы сэкономить место на сервере магазина);

* непосредственно на сервере вашего магазина (загрузить файлы можно через :doc:`Редактор файлов </user_guide/files/index>`).


Загрузка файлов на внешний сервер
=================================

Загрузка файлов на внешний сервер позволит вам сэкономить место на сервере с вашей установкой CS-Cart. Когда покупатель захочет скачать ваш файл с витрины, он будет скачивать его не из вашего магазина, а из того места, где файл хранится.

#. Загрузите все необходимые файлы на любой файлообменник.

#. В импортируемом файле укажите ссылки на файлы, например::

       http://www.example.com/test_file.pdf
       
#. Откройте страницу **Модули → Скачанные модули**.

#. Найдите в списке модуль **Прикреплённые файлы** и нажмите на его название, чтобы открыть настройки.

#. Убедитесь, что напротив единственной настройки модуля **Сохранять прикреплённые файлы на сервер** галочка снята. Это означает, что при импорте файлы останутся на сервере хранения файлов и не будут скопированы в ваш магазин. 

   .. fancybox:: img/attachments_settings-1.png
       :alt: Настройки модуля Прикреплённые файлы
       
   .. important::
   
       Если файл на внешнем сервере изменится, пользователям станет доступен уже новый файл. Сохранение прикреплённых файлов позволяет этого избежать, но замедляет процесс импорта и требует большого количества места на вашем сервере.
       
       
Загрузка файлов на сервер магазина
==================================

#. Откройте страницу **Настройки → Хранилище данных → См.файлы** в панели администратора CS-Cart.

#. Выберите раздел **Служебные файлы**.

#. Перейдите в папку *exim/backup/attachments*. Если этой папки не существует, создайте её.

#. Загрузите туда нужные файлы. Теперь вы можете ссылаться на них в импортируемом файле одним из следующих способов:

   * **Способ 1**. Абсолютный путь из корневой директории сервера до файлов. Например::
     
         /path/to/cs-cart/var/files/1/test_file.pdf
   
   * **Способ 2**. Относительный путь до файла из раздела Служебные файлы. Например::
   
         exim/backup/attachments/test_file.pdf
         
   * **Способ 3**. Только название файла::
   
         test_file.pdf
         
     .. fancybox:: img/file_editor_attachments-1.png
         :alt: Редактор файлов


Пример импорта файлов
=====================

#. Подготовьте файлы и загрузите их через **Редактор файлов**. Например, загрузим их в *exim/backup/attachments*.

#. Подготовьте импортируемый файл. Укажите в этом файле данные о товарах так, как описано :doc:`в этой статье </user_guide/manage_products/import_export/fields_format.html>`.

#. Ниже есть пример содержимого в импортируемом файле. Вы можете скопировать этот пример в пустой файл *.txt*, поменять его расширение на *.csv*, а затем открыть документ в любом редакторе таблиц, например, `LibreOffice Calc <https://www.libreoffice.org/discover/calc/>`_.

   ::
   
       Product code; Language; Product name; Attachments
       "T1"; "ru"; "1й тестовый товар"; "test_file.pdf"
       "T2"; "ru"; "2й тестовый товар"; "test_file.pdf"
       
   Вот что означает содержимое файла:

   * **Product code** — определяет, к какому товару относится файл. Если вы введёте несуществующий код, то будет создан новый товар с указанным файлом.
   
   * **Language** — код языка из двух букв, например, ``ru``. Это необходимое поле для импорта товаров.
   
   * **Attachments** — названия файлов (а иногда и пути к ним).
   
#. :doc:`Импортируйте товары </user_guide/manage_products/import_export/advanced_product_import>`. На вкладке **Таблица соответствия полей** обязательно укажите соответствие для каждого из столбцов со свойством товара в CS-Cart. У большинства столбцов названия совпадают со свойствами; для столбца **Attachments** укажите соответствие с **Attachments (Прикреплённые файлы)**.

   .. note::
   
       Если нужно, вы можете перейти на вкладку **Настройки** и поставить галочку **Удалить существующие дополнительные файлы** в дополнительных настройках. Так вы замените старые файлы на новые, а не добавите новые файлы к старым.
 


