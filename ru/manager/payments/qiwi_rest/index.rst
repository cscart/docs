QIWI REST
---------

Описание
========

Большой выбор способов оплаты поможет зарабатывать больше

*Пользователь сможет выбрать самый удобный для себя способ оплаты ваших товаров и услуг*

Официальный сайт: |link|

.. |link| raw:: html

   <!--noindex--><a href="https://ishop.qiwi.com/public/desc.action" target="_blank" rel="nofollow">ishop.qiwi.com</a><!--/noindex-->

Доступные способы оплаты:

*   Банковские карты  
*   Платежные терминалы
*   Со счёта мобильного телефона 
*   Интернет-банкинг       
*   Кошелек QIWI

.. note:: Ограничение по сумме заказа 15000 рублей для неавторизованных в системе QIWI покупателей.

Настройка на стороне Qiwi
=========================

1.  Зарегистрируйте интернет-магазин в системе QIWI.

2.  Перейдите в раздел Настройки - Протоколы - REST протокол.

    .. fancybox:: img/qiwi_rest.png
        :alt: QIWI REST panel

3.  Сгенерируйте новый ID.

    .. fancybox:: img/generate_id.png
        :alt: Generate ID

4.  Включите "Настройки Pull (REST) протокола" и "Включить уведомления".

    .. fancybox:: img/enable_rest.png
        :alt: Enable REST notification

5.  В поле "URL для оповещения" укажите (HTTPS протокол).

    ``https://ваш_домен/index.php?dispatch=payment_notification.notify&payment=qiwi_rest``

Настройка в магазине
====================

1.  Установите модуль "Qiwi REST платежная система"

2.  Создайте новый способ оплаты в панели администратора (:doc:`Инструкция </manager/payments/index>`).

3.  Выберите процессор оплаты "QIWI REST" в окне редактирования способа оплаты.

    .. fancybox:: img/qiwi_payment.png
        :alt: QIWI

4.  Пройдите во вкладку "Настроить" нового способа оплаты и выполните настройку.

    .. fancybox:: img/qiwi_settings.png
        :alt: QIWI

    Доступные настройки:

    .. list-table::
        :header-rows: 1
        :stub-columns: 1
        :widths: 10 30

        *   -   Настройка
            -   Описание

        *   -   Shop ID
            -   ID проекта из раздела "Аутентификационные данные"

        *   -   API ID
            -   Идентификатор пользователя, который показывается при генериации нового ID

        *   -   API пароль
            -   Пароль, который показывается при генериации нового ID

        *   -   Выберите время жизни счёта
            -   1 час, 12 часов, 1 день, неделя, две недели, месяц

        *   -   Тип накладной
            -   Просто создать счет в ЛК или переадресовать покупателя на страницу QIWI

        *   -   Писать логи
            -   При включении настроки все операции будут записываться в текстовый файл

        *   -   Валюта
            -   Валюта в который будут приниматся платежи

        *   -   Соответствие статусов заказов
            -   Необходимо указать статусы заказов в вашем магазине, которые соответствуют статусам QIWI

5.  Проверьте работу создав тестовый заказ.

Как это работает
================

Покупатель сможет выбрать метод оплаты QIWI, на странице оформления заказа. Покупателю будет предложено ввести номер мобильного телефона, на который будет создан счёт в личном кабинете QIWI покупателя. Если у него нет аккаунта QIWI, то он будет создан. Покупатель оплачивает счёт удобным ему способом, в течении срока действия счёта, который вы устанавливаете.

.. image:: img/qiwi_use.png
    :alt: Qiwi wallet